<mat-card class="reg-card">
  <h2>Register</h2>

  <form [formGroup]="form" (ngSubmit)="onSubmit()">
    <p class="server-msg" *ngIf="serverMessage">{{ serverMessage }}</p>
    <div class="row">
      <!-- First Name -->
      <mat-form-field appearance="outline" class="flex">
        <mat-label>First name</mat-label>
        <input matInput formControlName="firstName" autocomplete="given-name" />
        <mat-error *ngIf="f['firstName'].touched && f['firstName'].errors?.['required']">
          First name is required
        </mat-error>
        <mat-error *ngIf="f['firstName'].errors?.['minlength']"> Minimum 2 characters </mat-error>
      </mat-form-field>

      <!-- Last Name -->
      <mat-form-field appearance="outline" class="flex">
        <mat-label>Last name</mat-label>
        <input matInput formControlName="lastName" autocomplete="family-name" />
        <mat-error *ngIf="f['lastName'].touched && f['lastName'].errors?.['required']">
          Last name is required
        </mat-error>
        <mat-error *ngIf="f['lastName'].errors?.['minlength']"> Minimum 2 characters </mat-error>
      </mat-form-field>
    </div>

    <!-- Email -->
    <mat-form-field appearance="outline" class="full">
      <mat-label>Email</mat-label>
      <input matInput formControlName="email" type="email" autocomplete="email" />
      <mat-error *ngIf="f['email'].touched && f['email'].errors?.['required']">
        Email is required
      </mat-error>
      <mat-error *ngIf="f['email'].errors?.['email']"> Enter a valid email </mat-error>
    </mat-form-field>

    <!-- Password -->
    <mat-form-field appearance="outline" class="full">
      <mat-label>Password</mat-label>
      <input
        matInput
        [type]="hidePassword ? 'password' : 'text'"
        formControlName="password"
        autocomplete="new-password"
      />
      <button
        mat-icon-button
        matSuffix
        type="button"
        (click)="hidePassword = !hidePassword"
        [attr.aria-label]="'Toggle password'"
      >
        <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <mat-hint>At least 8 characters</mat-hint>
      <mat-error *ngIf="f['password'].touched && f['password'].errors?.['required']">
        Password is required
      </mat-error>
      <mat-error *ngIf="f['password'].errors?.['minlength']"> Minimum 8 characters </mat-error>
    </mat-form-field>

    <!-- Confirm Password -->
    <mat-form-field appearance="outline" class="full">
      <mat-label>Confirm password</mat-label>
      <input
        matInput
        [type]="hidePassword ? 'password' : 'text'"
        formControlName="confirmPassword"
        autocomplete="new-password"
      />
      <mat-error *ngIf="form.errors?.['passwordsMismatch'] && form.touched">
        Passwords do not match
      </mat-error>
      <mat-error *ngIf="f['confirmPassword'].touched && f['confirmPassword'].errors?.['required']">
        Please confirm password
      </mat-error>
    </mat-form-field>

    <!-- Actions -->
    <div class="actions">
      <button mat-flat-button color="primary" type="submit" [disabled]="loading">
        {{ loading ? 'Registering...' : 'Register' }}
      </button>
    </div>
  </form>

  <p class="text-center">
    Already have an account?
    <a [routerLink]="['/login']">Login</a>
  </p>
</mat-card>
